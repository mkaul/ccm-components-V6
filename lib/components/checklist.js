ccm.component({name:"checklist",config:{key:"demo",html:[ccm.load,"http://mkaul.github.io/ccm-components/lib/jsonp/checklist_html.json"],store:[ccm.store,{db:"redis",store:"checklist",url:"ws://ccm2.inf.h-brs.de/index.js"}],text_placeholder:"Hier neue Aufgabe eingeben...",text_delete:"Entfernen"},Instance:function(){var t=this;this.init=function(e){t.store.onChange=function(){ccm.helper.tagExists(t.element.find("> #"+ccm.helper.getElementID(t)))&&t.render()},e&&e()},this.render=function(e){var n=ccm.helper.element(t);t.store.get(t.key,function(s){function i(e){function i(t){var e=t.val(),n=e.length+1,s=t.attr("placeholder").length+1;t.attr("size",""===e&&s>n?s:n)}var o=s.tasks[e],c=t.html.task,l=ccm.helper.html(c,function(){n.find("button").hide(),e!==s.tasks.length-1&&jQuery(this).find("button").show()},o.completed,function(){o.completed=!o.completed,t.store.set(s,function(){t.bigdata&&t.bigdata.log("checkbox",{key:t.key,task:o})})},o.text||"",t.text_placeholder,function(){var n=jQuery(this);s.tasks[e].text=n.val().trim(),i(n),e===s.tasks.length-1&&(l.find("button").show(),a()),t.store.set(s,function(){t.bigdata&&t.bigdata.log("input",{key:t.key,task:o})})},t.text_delete,function(){s.tasks.splice(e,1),t.store.set(s,function(){t.bigdata&&t.bigdata.log("delete",{key:t.key,task:o}),t.render()})});i(l.find('input[type="text"]')),n.append(l)}function a(){var t=0===s.tasks.length?null:s.tasks[s.tasks.length-1];(!t||t.text&&""!==t.text.trim())&&(s.tasks.push({}),i(s.tasks.length-1))}if(null===s)return t.store.set({key:t.key},function(e){t.key=e.key,t.render()});s.tasks||(s.tasks=[]),n.html("");for(var o=0;o<s.tasks.length;o++)i(o);a(),n.find("button").hide(),e&&e(),t.bigdata&&t.bigdata.log("render",t.key)})}}});